// HTTP Client Tools Exploitation for ATO Detection

// https://www.proofpoint.com/us/blog/threat-insight/http-client-tools-exploitation-account-takeover-attacks

let HTTPClientTools=externaldata(RawData:string)
[h'https://raw.githubusercontent.com/SlimKQL/Hunting-Queries-Detection-Rules/refs/heads/main/IOC/Proofpoint_HTTPClientTools_ATO.txt']
| parse RawData with IOC:string;
let HTTPClientToolsIOC =
HTTPClientTools
| project IOC;
CloudAppEvents
| where TimeGenerated > ago(1h)
| where UserAgent has_any(HTTPClientToolsIOC) and ISP has_any(HTTPClientToolsIOC)

